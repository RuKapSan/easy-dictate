<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Easy Dictate</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <!-- Tab Navigation -->
  <nav class="tab-nav">
    <button class="tab-btn active" data-tab="main">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/>
        <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
        <line x1="12" x2="12" y1="19" y2="22"/>
      </svg>
      <span data-i18n="tab.dictation">Dictation</span>
    </button>
    <button class="tab-btn" data-tab="settings">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
        <circle cx="12" cy="12" r="3"/>
      </svg>
      <span data-i18n="tab.settings">Settings</span>
    </button>
    <span class="tab-spacer"></span>
    <span class="version-badge">v<span id="app-version">-</span></span>
    <button id="checkUpdatesBtn" class="check-updates-btn" title="Check for updates">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="23 4 23 10 17 10"></polyline>
        <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
      </svg>
    </button>
    <span id="updateStatus" class="update-status" hidden></span>
    <button id="installUpdateBtn" class="install-update-btn" hidden></button>
  </nav>

  <!-- Main Tab: Dictation & History -->
  <main class="tab-content active" data-tab="main">
    <!-- Status Section -->
    <section class="status-section">
      <div class="status-hero">
        <div id="status-orb" class="status-orb idle"></div>
        <div class="status-info">
          <div id="status-text" class="status-text" data-i18n="status.ready">Ready to record</div>
          <div id="status-hint" class="status-hint" data-i18n="status.hint.ready">Press hotkey to start</div>
        </div>
      </div>
      <progress id="progress" max="1" value="0" hidden></progress>
      <pre id="last-result" class="result" hidden></pre>
    </section>

    <!-- History Section -->
    <section class="history-section">
      <div class="section-header">
        <h2 data-i18n="history.title">History</h2>
        <button type="button" class="clear-history-btn" id="clearHistoryBtn" data-i18n-title="history.clear" title="Clear history">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
        </button>
      </div>
      <div id="historyList" class="history-list">
        <p class="history-empty" data-i18n="history.empty">No records</p>
      </div>
    </section>
  </main>

  <!-- Settings Tab -->
  <main class="tab-content" data-tab="settings">
    <form id="settings-form">
      <!-- Two-column layout -->
      <div class="settings-grid">
        <!-- LEFT COLUMN -->
        <div class="settings-column">
          <!-- Transcription Section -->
          <section class="settings-group">
            <h3 data-i18n="provider.title">Transcription</h3>
            <div class="provider-selector">
              <label class="provider-option">
                <input type="radio" name="provider" value="openai" />
                <span class="provider-card">
                  <span class="provider-name" data-i18n="provider.openai.name">OpenAI</span>
                  <span class="provider-desc" data-i18n="provider.openai.desc">Whisper, GPT-4o</span>
                </span>
              </label>
              <label class="provider-option">
                <input type="radio" name="provider" value="groq" checked />
                <span class="provider-card">
                  <span class="provider-name" data-i18n="provider.groq.name">Groq</span>
                  <span class="provider-desc" data-i18n="provider.groq.desc">Fast and free</span>
                </span>
              </label>
              <label class="provider-option">
                <input type="radio" name="provider" value="elevenlabs" />
                <span class="provider-card">
                  <span class="provider-name" data-i18n="provider.elevenlabs.name">ElevenLabs</span>
                  <span class="provider-desc" data-i18n="provider.elevenlabs.desc">Realtime streaming</span>
                </span>
              </label>
            </div>

            <!-- API Keys -->
            <div class="api-key-field" id="openai-api-key-field">
              <label>
                <span data-i18n="apikey.openai">OpenAI API Key</span>
                <div class="password-field">
                  <input type="password" id="apiKey" autocomplete="off" placeholder="sk-..." />
                  <button type="button" class="toggle-password" data-target="apiKey" data-i18n-title="apikey.show" title="Show/hide">
                    <svg class="eye-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                      <circle cx="12" cy="12" r="3"/>
                    </svg>
                  </button>
                </div>
              </label>
            </div>
            <div class="api-key-field" id="groq-api-key-field" hidden>
              <label>
                <span data-i18n="apikey.groq">Groq API Key</span>
                <div class="password-field">
                  <input type="password" id="groqApiKey" autocomplete="off" placeholder="gsk_..." />
                  <button type="button" class="toggle-password" data-target="groqApiKey" data-i18n-title="apikey.show" title="Show/hide">
                    <svg class="eye-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                      <circle cx="12" cy="12" r="3"/>
                    </svg>
                  </button>
                </div>
              </label>
            </div>
            <div class="api-key-field" id="elevenlabs-api-key-field" hidden>
              <label>
                <span data-i18n="apikey.elevenlabs">ElevenLabs API Key</span>
                <div class="password-field">
                  <input type="password" id="elevenlabsApiKey" autocomplete="off" placeholder="sk_..." />
                  <button type="button" class="toggle-password" data-target="elevenlabsApiKey" data-i18n-title="apikey.show" title="Show/hide">
                    <svg class="eye-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                      <circle cx="12" cy="12" r="3"/>
                    </svg>
                  </button>
                </div>
              </label>
            </div>

            <label>
              <span data-i18n="model.label">Model</span>
              <select id="model">
                <option value="gpt-4o-transcribe">gpt-4o-transcribe</option>
                <option value="gpt-4o-mini-transcribe">gpt-4o-mini-transcribe</option>
                <option value="whisper-1">whisper-1 (fallback)</option>
                <option value="groq/whisper-large-v3-turbo" selected>Groq Whisper Large v3 Turbo</option>
                <option value="groq/whisper-large-v3">Groq Whisper Large v3</option>
              </select>
            </label>
          </section>

          <!-- Hotkeys Section -->
          <section class="settings-group">
            <h3 data-i18n="hotkeys.title">Hotkeys</h3>
            <div class="hotkeys-grid">
              <div class="hotkey-item">
                <span class="hotkey-label-text" data-i18n="hotkeys.main">Main</span>
                <div class="hotkey-row">
                  <span id="hotkeyDisplay" class="hotkey-field" tabindex="0" data-i18n-placeholder="hotkeys.notset" data-placeholder="Not set" data-empty="true">Not set</span>
                  <button type="button" class="hotkey-clear" id="hotkeyClear" data-i18n-title="hotkeys.reset" title="Reset">&times;</button>
                  <input type="hidden" id="hotkey" />
                </div>
              </div>
              <div class="hotkey-item">
                <span class="hotkey-label-text" data-i18n="hotkeys.translate">With translation</span>
                <div class="hotkey-row">
                  <span id="translateHotkeyDisplay" class="hotkey-field" tabindex="0" data-i18n-placeholder="hotkeys.notset" data-placeholder="Not set" data-empty="true">Not set</span>
                  <button type="button" class="hotkey-clear" id="translateHotkeyClear" data-i18n-title="hotkeys.reset" title="Reset">&times;</button>
                  <input type="hidden" id="translateHotkey" />
                </div>
              </div>
              <div class="hotkey-item">
                <span class="hotkey-label-text" data-i18n="hotkeys.toggle">Toggle translation</span>
                <div class="hotkey-row">
                  <span id="toggleTranslateHotkeyDisplay" class="hotkey-field" tabindex="0" data-i18n-placeholder="hotkeys.notset" data-placeholder="Not set" data-empty="true">Not set</span>
                  <button type="button" class="hotkey-clear" id="toggleTranslateHotkeyClear" data-i18n-title="hotkeys.reset" title="Reset">&times;</button>
                  <input type="hidden" id="toggleTranslateHotkey" />
                </div>
              </div>
            </div>
          </section>

          <!-- Behavior Section -->
          <section class="settings-group">
            <h3 data-i18n="behavior.title">Behavior</h3>
            <div class="switches-grid compact-grid">
              <label class="switch-row compact">
                <input type="checkbox" id="simulateTyping" />
                <span class="switch-text">
                  <span class="switch-title" data-i18n="behavior.typing">Simulate typing</span>
                  <span class="switch-hint" data-i18n="behavior.typing.hint">Type text into active window</span>
                </span>
              </label>
              <label class="switch-row compact">
                <input type="checkbox" id="copyToClipboard" />
                <span class="switch-text">
                  <span class="switch-title" data-i18n="behavior.clipboard">Copy to clipboard</span>
                  <span class="switch-hint" data-i18n="behavior.clipboard.hint">Copy result to clipboard</span>
                </span>
              </label>
              <label class="switch-row compact">
                <input type="checkbox" id="useStreaming" checked />
                <span class="switch-text">
                  <span class="switch-title" data-i18n="behavior.streaming">Realtime text</span>
                  <span class="switch-hint" data-i18n="behavior.streaming.hint">Show text while recording</span>
                </span>
              </label>
            </div>
          </section>
        </div>

        <!-- RIGHT COLUMN -->
        <div class="settings-column">
          <!-- Processing Section (Translation + Instructions combined) -->
          <section class="settings-group">
            <h3 data-i18n="processing.title">Processing</h3>

            <!-- Translation toggle -->
            <label class="switch-row">
              <input type="checkbox" id="autoTranslate" />
              <span class="switch-text">
                <span class="switch-title" data-i18n="translation.enable">Translate result</span>
                <span class="switch-hint" data-i18n="translation.enable.hint">Auto-translate after transcription</span>
              </span>
            </label>
            <div class="translation-options" id="translationOptions">
              <div class="inline-fields">
                <label class="inline-field">
                  <span data-i18n="translation.language">Language</span>
                  <select id="targetLanguage">
                    <option value="Russian" data-i18n="lang.russian">Russian</option>
                    <option value="English" data-i18n="lang.english">English</option>
                    <option value="German" data-i18n="lang.german">German</option>
                    <option value="French" data-i18n="lang.french">French</option>
                    <option value="Spanish" data-i18n="lang.spanish">Spanish</option>
                    <option value="Italian" data-i18n="lang.italian">Italian</option>
                    <option value="Portuguese" data-i18n="lang.portuguese">Portuguese</option>
                    <option value="Chinese" data-i18n="lang.chinese">Chinese</option>
                    <option value="Japanese" data-i18n="lang.japanese">Japanese</option>
                    <option value="Korean" data-i18n="lang.korean">Korean</option>
                  </select>
                </label>
                <label class="inline-field">
                  <span data-i18n="translation.llm">LLM</span>
                  <select id="llmProvider">
                    <option value="openai">OpenAI GPT-4o-mini</option>
                    <option value="groq" selected>Groq Llama</option>
                  </select>
                </label>
              </div>
            </div>

            <!-- Custom instructions toggle -->
            <label class="switch-row mt-section">
              <input type="checkbox" id="useCustomInstructions" />
              <span class="switch-text">
                <span class="switch-title" data-i18n="instructions.enable">Custom instructions</span>
                <span class="switch-hint" data-i18n="instructions.enable.hint">Post-process text via LLM</span>
              </span>
            </label>
            <div class="custom-instructions-field" id="customInstructionsWrapper">
              <textarea id="customInstructions" rows="3"
                data-i18n-placeholder="instructions.placeholder"
                placeholder="E.g.: Make a brief summary, fix grammar, format as list..."></textarea>
            </div>

            <!-- Vocabulary toggle -->
            <label class="switch-row mt-section">
              <input type="checkbox" id="useVocabulary" />
              <span class="switch-text">
                <span class="switch-title" data-i18n="vocabulary.enable">Custom vocabulary</span>
                <span class="switch-hint" data-i18n="vocabulary.enable.hint">Fix technical terms via LLM</span>
              </span>
            </label>
            <div class="vocabulary-field" id="vocabularyWrapper">
              <textarea id="customVocabulary" rows="4"
                data-i18n-placeholder="vocabulary.placeholder"
                placeholder="One term per line: Groq, Tauri, WebSocket..."></textarea>
              <div class="vocabulary-footer">
                <span class="vocabulary-count" id="vocabularyCount">0 <span data-i18n="vocabulary.terms">terms</span></span>
                <div class="vocabulary-actions">
                  <button type="button" class="vocabulary-btn" id="importVocabulary" data-i18n="vocabulary.import">Import</button>
                  <button type="button" class="vocabulary-btn" id="exportVocabulary" data-i18n="vocabulary.export">Export</button>
                </div>
              </div>
            </div>
          </section>

          <!-- System Section -->
          <section class="settings-group">
            <h3 data-i18n="system.title">System</h3>
            <div class="switches-grid compact-grid">
              <label class="switch-row compact">
                <input type="checkbox" id="autoStart" />
                <span class="switch-text">
                  <span class="switch-title" data-i18n="system.autostart">Auto-start</span>
                  <span class="switch-hint" data-i18n="system.autostart.hint">Launch on Windows startup</span>
                </span>
              </label>
              <label class="switch-row compact">
                <input type="checkbox" id="startMinimized" />
                <span class="switch-text">
                  <span class="switch-title" data-i18n="system.tray">Start minimized</span>
                  <span class="switch-hint" data-i18n="system.tray.hint">Minimize to tray on launch</span>
                </span>
              </label>
              <label class="switch-row compact">
                <input type="checkbox" id="autoUpdate" checked />
                <span class="switch-text">
                  <span class="switch-title" data-i18n="system.autoupdate">Auto-update</span>
                  <span class="switch-hint" data-i18n="system.autoupdate.hint">Check for new versions</span>
                </span>
              </label>
            </div>
            <!-- Language selector -->
            <label class="language-selector">
              <span data-i18n="system.language">Interface language</span>
              <select id="uiLanguage">
                <option value="en">English</option>
                <option value="ru">Русский</option>
              </select>
            </label>
          </section>
        </div>
      </div>

      <!-- Sticky Actions (full width) -->
      <div class="actions-sticky">
        <button type="button" id="revertBtn" data-i18n="actions.revert">Revert</button>
        <button type="submit" id="saveBtn" data-i18n="actions.save">Save</button>
      </div>
    </form>
  </main>

  <div id="toast" hidden></div>

  <script src="i18n.js"></script>
  <script src="elevenlabs-stt.js" defer></script>
  <script src="main.js" defer></script>
</body>

</html>
